<!DOCTYPE html>
<html>
<head>
<title>sudoku solver</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<style type="text/css">
body {
    background-color: black;
    color: #e0e0e0;
    font-size: 40px;
    font-family: arial;
}
table {
    border-collapse: collapse;
}
td {
    border: 2px solid white;
    padding: 0;
}
.game, .set {
    text-align: center;
    width: 65px;
    height: 65px;
}
.set {
    font-weight: bold;
    font-size: 50px;
    width: 100px;
    height: 100px;
}
input[type=button] {
    font-size: 30px;
    padding: 10px 20px;
}
</style>

<script type="text/javascript">
var number = " ";
var idCell = "game_0_0";

function setCell(_this)
{
    var elements = document.getElementsByClassName("game");
    for (i = 0; i < elements.length; i++) {
        elements[i].style.backgroundColor = "black";
    }
    idCell = _this.id;
    _this.style.backgroundColor = "green";
}

function setNumber(_number)
{
    number = _number;
    var cell = document.getElementById(idCell);
    cell.innerHTML = number;
    if (" " == number) {
        cell.style.fontWeight = "normal";
    } else {
        cell.style.fontWeight = "bold";
        cell.style.color      = "#ffffff";
    }
}

function putNumber(_this)
{
    _this.innerHTM = number;
}

function clearAll()
{
    var elements = document.getElementsByClassName("game");
    for (i = 0; i < elements.length; i++) {
        elements[i].innerHTML = " ";
        elements[i].style.backgroundColor = "black";
        elements[i].style.fontWeight = "normal";
        elements[i].style.color      = "#e0e0e0";
    }
}

function solveAll(online)
{
    var time_begin = new Date().getTime();
    var s = "";
    var number = " ";
    for (var r = 0; r < 9; r ++) {
        for (var c = 0; c < 9; c ++) {
            number = " ";
            var cell = document.getElementById("game_" + r + "_" + c)
            if ("bold" == cell.style.fontWeight) {
                number = cell.innerHTML;
            }
            if (true == online) {
                s = s + number + ",";
            } else {
                s = s + number;
            }
        }
    }

    if (true == online) {
        var json = objAjaxJson("sud", "solve", "rows=" + s);
        var rows = json.rows;
    } else {
        var rows = new SudokuSolver().solve(s, { result: "chunks" });
    }

    if (Array.isArray(rows)) {
        document.getElementById("error").innerHTML = "";
        for (var r = 0; r < 9; r ++) {
            for (var c = 0; c < 9; c ++) {
                document.getElementById("game_" + r + "_" + c).innerHTML = rows[r][c];
            }
        }
    } else {
        document.getElementById("error").innerHTML = rows;
    }

    document.getElementById("time").innerHTML = (new Date().getTime() - time_begin) / 1000.0;
}


function SudokuSolver()
{
    var puzzle_table = [];

    /*
    * Check if the number is a legal candidate
    * for the given cell (by Sudoku rules).
    */
    function check_candidate(num, row, col)
    {
        for (var i = 0; i < 9; i++) {
            var b_index = ((Math.floor(row / 3) * 3) + Math.floor(i / 3)) * 9 + (Math.floor(col / 3) * 3) + (i % 3);
            if (num == puzzle_table[(row * 9) + i] || num == puzzle_table[col + (i * 9)] || num == puzzle_table[b_index]) {
                return false;
            }
        }
        return true;
    }

    /*
    * Recursively test all possible numbers for a given cell until
    * the puzzle is solved.
    */
    function get_candidate(index)
    {
        if (index >= puzzle_table.length) {
            return true;
        } else if (puzzle_table[index] != 0) {
            return get_candidate(index + 1);
        }

        for (var i = 1; i <= 9; i++) {
            if (check_candidate(i, Math.floor(index / 9), index % 9)) {
                puzzle_table[index] = i;
                if (get_candidate(index + 1)) {
                    return true;
                }
            }
        }

        puzzle_table[index] = 0;
        return false;
    }

    /*
    * Split result of puzzle into chunks by 9.
    */
    function chunk_in_groups(arr)
    {
        var result = [];
        for (var i = 0; i < arr.length; i += 9) {
            result.push(arr.slice(i, i + 9));
        }
        return result;
    }

    /*
    * Start solving the game for provided puzzle and options.
    */
    this.solve = function (puzzle, options)
    {
        options = options || {};
        var result = options.result || 'string';
        puzzle_table = puzzle.split('').map(function (v) {
            return isNaN(v) ? 0 : +v
        });

        if (puzzle.length !== 81) {
            return 'Puzzle is not valid.'
        }

        return !get_candidate(0) ? 'No solution found.' : result === 'chunks' ? chunk_in_groups(puzzle_table) : result === 'array' ? puzzle_table : puzzle_table.join('');
    }
}
</script>

</head>
<body>

<table>
<tbody>
<tr valign="top">
    <td style="border: 0;">
        <table>
        <tbody>
        <tr>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_0_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_0_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_0_2" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_1_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_1_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_1_2" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_2_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_2_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_2_2" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_0_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_0_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_0_5" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_1_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_1_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_1_5" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_2_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_2_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_2_5" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_0_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_0_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_0_8" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_1_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_1_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_1_8" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_2_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_2_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_2_8" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
        </tr>
        <tr>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_3_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_3_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_3_2" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_4_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_4_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_4_2" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_5_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_5_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_5_2" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_3_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_3_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_3_5" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_4_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_4_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_4_5" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_5_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_5_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_5_5" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_3_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_3_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_3_8" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_4_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_4_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_4_8" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_5_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_5_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_5_8" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
        </tr>
        <tr>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_6_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_6_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_6_2" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_7_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_7_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_7_2" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_8_0" onclick="setCell(this)"> </td>
                    <td class="game" id="game_8_1" onclick="setCell(this)"> </td>
                    <td class="game" id="game_8_2" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_6_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_6_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_6_5" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_7_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_7_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_7_5" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_8_3" onclick="setCell(this)"> </td>
                    <td class="game" id="game_8_4" onclick="setCell(this)"> </td>
                    <td class="game" id="game_8_5" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
            <td>
                <table>
                <tbody>
                <tr>
                    <td class="game" id="game_6_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_6_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_6_8" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_7_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_7_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_7_8" onclick="setCell(this)"> </td>
                </tr>
                <tr>
                    <td class="game" id="game_8_6" onclick="setCell(this)"> </td>
                    <td class="game" id="game_8_7" onclick="setCell(this)"> </td>
                    <td class="game" id="game_8_8" onclick="setCell(this)"> </td>
                </tr>
                </tbody>
                </table>
            </td>
        </tr>
        </tbody>
        </table>
    </td>
    <td style="border: 0;">
        <table>
        <tbody>
        <tr>
            <td class="set" id="set_1" onclick="setNumber('1')">1</td>
            <td class="set" id="set_2" onclick="setNumber('2')">2</td>
            <td class="set" id="set_3" onclick="setNumber('3')">3</td>
        </tr>
        <tr>
            <td class="set" id="set_4" onclick="setNumber('4')">4</td>
            <td class="set" id="set_5" onclick="setNumber('5')">5</td>
            <td class="set" id="set_6" onclick="setNumber('6')">6</td>
        </tr>
        <tr>
            <td class="set" id="set_7" onclick="setNumber('7')">7</td>
            <td class="set" id="set_8" onclick="setNumber('8')">8</td>
            <td class="set" id="set_9" onclick="setNumber('9')">9</td>
        </tr>
        </tbody>
        </table>
        <input type="button" value="E"     onclick="setNumber(' ')">
        <input type="button" value="Clear" onclick="clearAll()">
        <input type="button" value="Solve" onclick="solveAll(false)">
    </td>
</tr>
</tbody>
</table>
<p id="error"></p>
<p id="time"></p>

</body></html>